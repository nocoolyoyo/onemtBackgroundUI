<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.wkt.dao.example.IExampleDao">

	<insert id="insertExample" parameterType="java.util.HashMap" useGeneratedKeys="true" keyProperty="id">
		INSERT INTO yj_example
		(
			title
			<if test="summary != null">
				,summary
			</if>
			<if test="user_id != null and user_id != ''">
				,user_id
			</if>
			<if test="user_type != null and user_type != ''">
				,user_type
			</if>
			<if test="user_avatar != null and user_avatar != ''">
				,user_avatar
			</if>
			<if test="user_name != null and user_name != ''">
				,user_name
			</if>
			<if test="user_identity != null and user_identity != ''">
				,user_identity
			</if>
			<if test="user_v != null and user_v != ''">
				,user_v
			</if>
			<if test="author_id != null and author_id != ''">
				,author_id
			</if>
			<if test="author_name != null and author_name != ''">
				,author_name
			</if>
			<if test="create_time != null and create_time != ''">
				,create_time,update_time
			</if>
			<if test="image != null and image != ''">
				,image
			</if>
			<if test="content != null and content != ''">
				,content
			</if>
			,state
			,status
		)VALUE(
			#{title}
			<if test="summary != null">
				,#{summary}
			</if>
			<if test="user_id != null and user_id != ''">
				,#{user_id}
			</if>
			<if test="user_type != null and user_type != ''">
				,#{user_type}
			</if>
			<if test="user_avatar != null and user_avatar != ''">
				,#{user_avatar}
			</if>
			<if test="user_name != null and user_name != ''">
				,#{user_name}
			</if>
			<if test="user_identity != null and user_identity != ''">
				,#{user_identity}
			</if>
			<if test="user_v != null and user_v != ''">
				,#{user_v}
			</if>
			<if test="author_id != null and author_id != ''">
				,#{author_id}
			</if>
			<if test="author_name != null and author_name != ''">
				,#{author_name}
			</if>
			<if test="create_time != null and create_time != ''">
				,#{create_time},#{create_time}
			</if>
			<if test="image != null and image != ''">
				,#{image}
			</if>
			<if test="content != null and content != ''">
				,#{content}
			</if>
			,#{state}
			,1
		)
	</insert>

	<select id="findExample" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		select *,(select realname from yj_yy_user where id = ye.update_id) as update_username from yj_example ye where 1=1
		<if test="status!=null and status!=''">
			and status=#{status}
		</if>
		<if test="state!=null and state!=''">
			and state in(${state})
		</if>
		<if test="title!=null and title!=''">
			and title like '%${title}%'
		</if>
		<if test="start_time!=null and start_time!=''">
			AND create_time >= #{start_time}
		</if>
		<if test="end_time!=null and end_time!=''">
			<![CDATA[ AND create_time <= #{end_time} ]]> 
		</if>
		<if test="start_update_time!=null and start_update_time!=''">
			AND update_time >= #{start_update_time}
		</if>
		<if test="end_update_time!=null and end_update_time!=''">
			<![CDATA[ AND update_time <= #{end_update_time} ]]> 
		</if>
			ORDER BY ye.update_time desc,ye.create_time desc
		<if test="y != null and y != ''">
			LIMIT ${x},${y}
		</if>
	</select>
	
	<select id="countExample" parameterType="java.util.HashMap" resultType="Integer">
		select count(*) from yj_example where 1=1
		<if test="status!=null and status!=''">
			and status=#{status}
		</if>
		<if test="state!=null and state!=''">
			and state in(${state})
		</if>
		<if test="title!=null and title!=''">
			and title like '%${title}%'
		</if>
		<if test="start_time!=null and start_time!=''">
			AND create_time >= #{start_time}
		</if>
		<if test="end_time!=null and end_time!=''">
			<![CDATA[ AND create_time <= #{end_time} ]]> 
		</if>
		<if test="start_update_time!=null and start_update_time!=''">
			AND update_time >= #{start_update_time}
		</if>
		<if test="end_update_time!=null and end_update_time!=''">
			<![CDATA[ AND update_time <= #{end_update_time} ]]> 
		</if>
	</select>
	
	<select id="getExampleById" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		select * from yj_example where id = #{id}
	</select>
	
	<update id="updateExample" parameterType="java.util.HashMap">
		update yj_example set update_time=#{update_time},update_id=#{update_id},update_type=2
		<if test="update_name !=null">,update_name=#{update_name}</if>
		<if test="summary!=null">,summary=#{summary}</if>
		<if test="title!=null and title!=''">,title=#{title}</if>
		<if test="user_id !=null and user_id !=''">,user_id=#{user_id}</if>
		<if test="user_type !=null and user_type !=''">,user_type=#{user_type}</if>
		<if test="user_avatar !=null and user_avatar !=''">,user_avatar=#{user_avatar}</if>
		<if test="user_name !=null and user_name !=''">,user_name=#{user_name}</if>
		<if test="user_identity !=null and user_identity !=''">,user_identity=#{user_identity}</if>
		<if test="user_v!=null and user_v!=''">,user_v=#{user_v}</if>
		<if test="image!=null and image!=''">,image=#{image}</if>
		<if test="content!=null and content!=''">,content=#{content}</if>
		<if test="is_top!=null and is_top!=''">,is_top=#{is_top}</if>
		<if test="show_times_count!=null and show_times_count!=''">,show_times_count=#{show_times_count}</if>
		<if test="show_people_count!=null and show_people_count!=''">,show_people_count=#{show_people_count}</if>
		<if test="visit_times_count!=null and visit_times_count!=''">,visit_times_count=#{visit_times_count}</if>
		<if test="visit_people_count!=null and visit_people_count!=''">,visit_people_count=#{visit_people_count}</if>
		<if test="zan_count!=null and zan_count!=''">,zan_count=#{zan_count}</if>
		<if test="favorite_count!=null and favorite_count!=''">,favorite_count=#{favorite_count}</if>
		<if test="share_count!=null and share_count!=''">,share_count=#{share_count}</if>
		<if test="comment_count!=null and comment_count!=''">,comment_count=#{comment_count}</if>
		<if test="view_times_count_all!=null and view_times_count_all!=''">,view_times_count_all=#{view_times_count_all}</if>
		<if test="view_people_count_all!=null and view_people_count_all!=''">,view_people_count_all=#{view_people_count_all}</if>
		<if test="zan_count_all!=null and zan_count_all!=''">,zan_count_all=#{zan_count_all}</if>
		<if test="favorite_count_all!=null and favorite_count_all!=''">,favorite_count_all=#{favorite_count_all}</if>
		<if test="share_count_all!=null and share_count_all!=''">,share_count_all=#{share_count_all}</if>
		<if test="comment_count_all!=null and comment_count_all!=''">,comment_count_all=#{comment_count_all}</if>
		<if test="audit_user_id!=null and audit_user_id!=''">,audit_user_id=#{audit_user_id}</if>
		<if test="audit_user_name!=null and audit_user_name!=''">,audit_user_name=#{audit_user_name}</if>
		<if test="status!=null and status!=''">,status=#{status}</if>
		<if test="audit_time!=null and audit_time!=''">,audit_time=#{audit_time}</if>
		<if test="audit_opinion!=null and audit_opinion!=''">,audit_opinion=#{audit_opinion}</if>
		<if test="state!=null and state!=''">,state=#{state}</if>
		where id=#{id}
	</update>

</mapper>